<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Love Letter for You</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Lato:wght@300;400;700&display=swap');
        body, html {
            scroll-behavior: smooth;
            font-family: 'Playfair Display', serif;
            overflow-x: hidden;
        }
        .bg-gradient-love {
            background: linear-gradient(135deg, #ff6b6b 0%, #ff9a9e 100%);
        }
        .shadow-romantic {
            box-shadow: 0 15px 35px rgba(255,106,107,0.2);
        }
        .rose-decoration {
            position: absolute;
            opacity: 0.4;
            z-index: 1;
            filter: drop-shadow(2px 2px 4px rgba(255,106,107,0.3));
            transition: transform 0.3s ease, opacity 0.3s ease;
        }
        .rose-decoration:hover {
            opacity: 0.7;
            transform: scale(1.05);
            cursor: pointer;
        }
        .scroll-disabled {
            overflow: hidden;
        }
        .clickme-text {
            animation: pulse 1.5s infinite;
        }
        .home-button {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 100;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }
        .home-button:hover {
            background: rgba(255, 255, 255, 0.9);
            transform: scale(1.05);
        }
        @keyframes pulse {
            0% { opacity: 0.7; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.05); }
            100% { opacity: 0.7; transform: scale(1); }
        }
        
        /* New scattered collage styles */
        .photo-collage {
            position: relative;
            min-height: 600px;
            padding: 20px;
            margin: 30px auto;
            max-width: 1200px;
        }
        .photo-item {
            position: absolute;
            width: 180px;
            height: 120px;
            background-color: white;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            padding: 5px;
            border-radius: 4px;
            cursor: pointer;
            transform: rotate(var(--rotation));
            transition: all 0.3s ease, z-index 0s;
            z-index: 1;
        }
        .photo-item:hover {
            transform: scale(1.1) rotate(var(--rotation));
            z-index: 100;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }
        .photo-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 2px;
        }
        .photo-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        .photo-modal.active {
            opacity: 1;
            pointer-events: auto;
        }
        .photo-modal img {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
        }
        .photo-modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            color: white;
            font-size: 30px;
            cursor: pointer;
        }
        .stiam-message {
            position: fixed;
            top: 20%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(255, 255, 255, 0.8);
            color: #ff6b6b;
            font-size: 3rem;
            padding: 1rem 2rem;
            border-radius: 5px;
            z-index: 9999;
            opacity: 0%;
            pointer-events: none;
            transition: opacity 0.5s ease;
        }
        @media (prefers-reduced-motion: reduce) {
            .clickme-text {
                animation: none;
            }
            .rose-decoration:hover {
                transform: none;
            }
            body, html {
                scroll-behavior: auto;
            }
            .transition-all {
                transition: none !important;
            }
        }
        /* Add this to your <style> section */
        @media (max-width: 768px) {
        .rose-decoration {
            width: 80px !important;
            height: 80px !important;
            opacity: 0.25; /* Make roses more transparent on mobile */
        }
        
        /* Adjust positions for mobile */
        .rose-decoration.top-10.left-10 {
            top: 5px;
            left: 5px;
        }
        
        .rose-decoration.top-20.right-10 {
            top: 10px;
            right: 5px;
        }
        
        .rose-decoration.bottom-20.left-20 {
            bottom: 10px;
            left: 10px;
        }
        
        .rose-decoration.bottom-10.right-10 {
            bottom: 5px;
            right: 5px;
        }
        
        .rose-decoration.top-1\/3.left-5,
        .rose-decoration.top-1\/3.right-5 {
            display: none; /* Hide some roses on mobile */
        }
        }
        /* Add this to your <style> section */
        @media (max-width: 768px) {
        .photo-collage {
            min-height: 1500px; /* Increase height for mobile */
        }
        
        .photo-item {
            width: 120px; /* Smaller photos on mobile */
            height: 80px;
        }
        }
        /* Add this to your <style> section */
        @media (max-width: 768px) {
        .letter-container {
            padding: 15px;
        }
        
        .letter-container .text-xl {
            font-size: 1rem;
        }
        
        .letter-container h2 {
            font-size: 1.5rem;
        }
        }
        #media-player {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 55px;
            height: 160px;
            background: rgba(255, 182, 193, 0.8);
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            padding: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(5px);
        }

            button {
            background: transparent;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: white;
            transition: transform 0.2s ease-in-out;
        }

            button:hover {
            transform: scale(1.2);
            }

            #volume-slider {
            writing-mode: vertical-lr;
            transform: rotate(180deg);
            width: 8px;
            height: 90px;
            appearance: none;
            background: white;
            border-radius: 5px;
            outline: none;
            }

            #volume-slider::-webkit-slider-thumb {
            appearance: none;
            width: 14px;
            height: 14px;
            background: #ff69b4;
            border-radius: 50%;
            cursor: pointer;
            transition: 0.2s;
            }

            #volume-slider::-webkit-slider-thumb:hover {
            background: #ff1493;
            }


    </style>
</head>
<body class="bg-gray-50 relative scroll-disabled">
    <!-- Home Button (initially hidden) -->
    <button id="homeButton" class="home-button px-4 py-2 text-rose-600 font-medium hidden" aria-label="Go back to home screen">
        Home
    </button>

    <!-- Rose Decorations -->
    <svg class="rose-decoration top-10 left-10 w-48 h-48" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200" aria-label="Decorative rose">
        <g transform="translate(100,100)">
            <path d="M0,-50 
                     Q-30,-50 -40,-30 
                     Q-50,-10 -30,10 
                     Q-10,30 10,10 
                     Q30,-10 20,-30 
                     Q10,-50 0,-50" 
                  fill="#E11584" />
            <path d="M0,-30 
                     Q-20,-30 -30,-15 
                     Q-40,0 -20,15 
                     Q0,30 20,15 
                     Q40,0 30,-15 
                     Q20,-30 0,-30" 
                  fill="#C2185B" />
            <path d="M0,-10 
                     Q-10,-10 -15,-5 
                     Q-20,0 -10,5 
                     Q0,10 10,5 
                     Q20,0 15,-5 
                     Q10,-10 0,-10" 
                  fill="#AD1457" />
            <g fill="green">
                <path d="M-5,50 Q-20,30 -10,10" />
                <path d="M5,50 Q20,30 10,10" />
                <path d="M0,60 Q0,40 0,10" />
            </g>
        </g>
    </svg>

    <svg class="rose-decoration top-20 right-10 w-56 h-56" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200" aria-label="Decorative rose">
        <g transform="translate(100,100) rotate(45)">
            <path d="M0,-50 
                     Q-30,-50 -40,-30 
                     Q-50,-10 -30,10 
                     Q-10,30 10,10 
                     Q30,-10 20,-30 
                     Q10,-50 0,-50" 
                  fill="#E11584" />
            <path d="M0,-30 
                     Q-20,-30 -30,-15 
                     Q-40,0 -20,15 
                     Q0,30 20,15 
                     Q40,0 30,-15 
                     Q20,-30 0,-30" 
                  fill="#C2185B" />
            <path d="M0,-10 
                     Q-10,-10 -15,-5 
                     Q-20,0 -10,5 
                     Q0,10 10,5 
                     Q20,0 15,-5 
                     Q10,-10 0,-10" 
                  fill="#AD1457" />
            <g fill="green" stroke="green" stroke-width="2">
                <path d="M-5,50 Q-20,30 -10,10" />
                <path d="M5,50 Q20,30 10,10" />
                <path d="M0,60 Q0,40 0,10" />
            </g>
        </g>
    </svg>

    <svg class="rose-decoration bottom-20 left-20 w-40 h-40" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200" aria-label="Decorative rose">
        <g transform="translate(100,100) rotate(-45)">
            <path d="M0,-50 
                     Q-30,-50 -40,-30 
                     Q-50,-10 -30,10 
                     Q-10,30 10,10 
                     Q30,-10 20,-30 
                     Q10,-50 0,-50" 
                  fill="#E11584" />
            <path d="M0,-30 
                     Q-20,-30 -30,-15 
                     Q-40,0 -20,15 
                     Q0,30 20,15 
                     Q40,0 30,-15 
                     Q20,-30 0,-30" 
                  fill="#C2185B" />
            <path d="M0,-10 
                     Q-10,-10 -15,-5 
                     Q-20,0 -10,5 
                     Q0,10 10,5 
                     Q20,0 15,-5 
                     Q10,-10 0,-10" 
                  fill="#AD1457" />
            <g fill="green" stroke="green" stroke-width="2">
                <path d="M-5,50 Q-20,30 -10,10" />
                <path d="M5,50 Q20,30 10,10" />
                <path d="M0,60 Q0,40 0,10" />
            </g>
        </g>
    </svg>

    <svg class="rose-decoration bottom-10 right-10 w-48 h-48" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200" aria-label="Decorative rose">
        <g transform="translate(100,100)">
            <path d="M0,-50 
                     Q-30,-50 -40,-30 
                     Q-50,-10 -30,10 
                     Q-10,30 10,10 
                     Q30,-10 20,-30 
                     Q10,-50 0,-50" 
                  fill="#E11584" />
            <path d="M0,-30 
                     Q-20,-30 -30,-15 
                     Q-40,0 -20,15 
                     Q0,30 20,15 
                     Q40,0 30,-15 
                     Q20,-30 0,-30" 
                  fill="#C2185B" />
            <path d="M0,-10 
                     Q-10,-10 -15,-5 
                     Q-20,0 -10,5 
                     Q0,10 10,5 
                     Q20,0 15,-5 
                     Q10,-10 0,-10" 
                  fill="#AD1457" />
            <g fill="green" stroke="green" stroke-width="2">
                <path d="M-5,50 Q-20,30 -10,10" />
                <path d="M5,50 Q20,30 10,10" />
                <path d="M0,60 Q0,40 0,10" />
            </g>
        </g>
    </svg>

    <!-- Additional Roses -->
    <svg class="rose-decoration top-1/3 left-5 w-32 h-32" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200" aria-label="Decorative rose">
        <g transform="translate(100,100) rotate(-20)">
            <path d="M0,-50 
                     Q-30,-50 -40,-30 
                     Q-50,-10 -30,10 
                     Q-10,30 10,10 
                     Q30,-10 20,-30 
                     Q10,-50 0,-50" 
                  fill="#E11584" />
            <g fill="green" stroke="green" stroke-width="2">
                <path d="M-5,50 Q-20,30 -10,10" />
                <path d="M5,50 Q20,30 10,10" />
            </g>
        </g>
    </svg>

    <svg class="rose-decoration top-1/3 right-5 w-32 h-32" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200" aria-label="Decorative rose">
        <g transform="translate(100,100) rotate(20)">
            <path d="M0,-50 
                     Q-30,-50 -40,-30 
                     Q-50,-10 -30,10 
                     Q-10,30 10,10 
                     Q30,-10 20,-30 
                     Q10,-50 0,-50" 
                  fill="#E11584" />
            <g fill="green" stroke="green" stroke-width="2">
                <path d="M-5,50 Q-20,30 -10,10" />
                <path d="M5,50 Q20,30 10,10" />
            </g>
        </g>
    </svg>

    <!-- Introduction Section -->
    <div id="introSection" class="min-h-screen flex flex-col justify-center items-center relative bg-gradient-love">
        <div class="intro-section text-center px-4 py-20 relative z-10">
            <h1 class="text-4xl md:text-6xl text-white font-bold mb-6 drop-shadow-lg">
                Claudia
            </h1>
            <p class="text-xl text-white max-w-2xl mx-auto opacity-90 mb-20">
                On this celebratory day, accept this letter from my behalf...
            </p>
            <p class="clickme-text text-white text-xl animate-pulse">
                Click the screen
            </p>
        </div>
    </div>

    <!-- Love question popup (initially hidden) -->
    <div id="loveQuestion" class="fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-60 hidden">
        <div class="bg-white rounded-xl p-8 max-w-md mx-4 shadow-romantic">
            <h2 class="text-2xl text-rose-600 font-bold mb-6 text-center">Do you love me?</h2>
            <div class="flex justify-center space-x-4">
                <button id="yesButton" class="px-6 py-3 bg-rose-500 text-white rounded-lg hover:bg-rose-600 transition-colors focus:outline-none focus:ring-2 focus:ring-rose-400" aria-label="Yes, I love you">Yes</button>
                <button id="yesyesButton" class="px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors focus:outline-none focus:ring-2 focus:ring-gray-400" aria-label="YesYes, I love you">YesYesYes</button>
            </div>
        </div>
    </div>

    <!-- Girlfriend question popup (initially hidden) -->
    <div id="girlfriendQuestion" class="fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-60 hidden">
        <div class="bg-white rounded-xl p-8 max-w-md mx-4 shadow-romantic">
            <h2 class="text-2xl text-rose-600 font-bold mb-6 text-center">Would you be my girlfriend?</h2>
            <div class="flex justify-center space-x-4">
                <button id="yesButton2" class="px-6 py-3 bg-rose-500 text-white rounded-lg hover:bg-rose-600 transition-colors focus:outline-none focus:ring-2 focus:ring-rose-400" aria-label="Yes">Yes</button>
                <button id="yesyesButton2" class="px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors focus:outline-none focus:ring-2 focus:ring-gray-400" aria-label="YesYes">Yes of course</button>
            </div>
        </div>
    </div>    

    <!-- Envelope section -->
    <div class="min-h-screen flex flex-col justify-center items-center relative bg-gray-50 envelope-scroll-stop hidden" id="envelopeSection">
        <div class="envelope-section opacity-0 transform translate-y-10 transition-all duration-1000 ease-out">
            <div class="envelope-container relative w-80 h-52 cursor-pointer group" tabindex="0" aria-label="Click to open the envelope">
                <div class="absolute inset-0 bg-white rounded-lg shadow-romantic transform transition-all duration-500 group-hover:rotate-6 group-hover:scale-105 envelope">
                    <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-40 bg-pink-50 rounded-lg shadow-inner">
                        <div class="absolute top-0 left-0 w-full h-1/2 bg-pink-100 rounded-t-lg"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Letter section -->
    <div class="min-h-screen bg-gray-100 flex flex-col justify-center items-center p-6 letter-section hidden">
        <div class="letter-container bg-white w-full max-w-2xl rounded-lg shadow-romantic p-10 opacity-0 transform translate-y-10 transition-all duration-1000 relative">
            
            <h2 class="text-4xl text-center text-rose-600 mb-8 font-bold">Happy Women's Day, My Owl</h2>
            <div class="text-xl text-gray-700 leading-relaxed space-y-6">
                <p>
                    Dear,
                </p>
                <p>
                    You mentioned in your letter that you care about me, and through this "letter" I want to show you how much I care for you.
                    You upset me much when you told me I am unable to show appreciation. I hope in the future you will change your opinion.
                    I hope now we are at peace with one another and that you are content with our bond - as we had our misunderstandings. But my
                    greatest torment since I have known you has been seeing you anguished.
                </p>
                <p>
                    I am nearly mad at you-nearly, as much as one can be mad. I cannot bring toghether two ideas that you do not interpose yourself between them.
                    The distance between us is breaking my spirit, yet in your memory, I find solace... perhaps it's monomania. You are my monomania. 
                    But just know that you can come to me at anytime. It is a lovely place which lacks only you.
                    I am mastering my love for you and turning it inwards as a constituent element of myself.
                    I'd like to paint you, but there are no colors, because there are so many-in my confusion, the tangible form of my love.
                </p>
                <p>
                    Love, I believe is a decision, not a feeling. And if it was it would be a feeling easily weakend and distorted. But you are capable of it.
                    You are always ready to give your love. I'm not talking only about your love for me, which is beyond that. But you are lavish with little secondary loves, like
                    your plushes, and your appreciation of the small things in life-or that night when you loved that drunkard you met at the bar, who turned out to be me.
                    Alas, falling in love with you was the easiest thing I've done. You are utterly lovable, and you fill my soul with ardent bliss.
                </p>
                <p>
                    I loved you when I met you, I love you today, and I will love you forever.
                    To infinity and beyond, no more ;).<br/>
                </p>
                <p class="text-right italic text-rose-600">
                    Yours,<br/>
                    Arkhan
                </p>
            </div>
            
            <div class="mt-12 text-center">
                <p class="clickme-text text-rose-600 text-xl animate-pulse cursor-pointer" id="viewGirlfriendButton">
                    Click here
                </p>
            </div>
        </div>
    </div>

    <!-- Photo Gallery Section (initially hidden) -->
    <div id="photoGallerySection" class="min-h-screen bg-gray-100 p-4 hidden">
        <div class="max-w-6xl mx-auto bg-white rounded-lg shadow-romantic p-6">
            <h2 class="text-3xl text-center text-rose-600 mb-8 font-bold">Our Memories</h2>
            
            <div class="photo-collage">
                <!-- Images will be dynamically placed here by JavaScript -->
            </div>
        </div>
    </div>
    
    <!-- Photo Modal -->
    <div id="photoModal" class="photo-modal">
        <div class="photo-modal-close">&times;</div>
        <img id="modalImage" src="" alt="Enlarged photo">
    </div>

    <div id="stiamMessage" class="stiam-message">
        Stiam :)
    </div>

    <div id="media-player">
        <button id="play-pause-btn">⏸️</button>  
        <button id="mute-btn">🔊</button>
        <input id="volume-slider" type="range" min="0" max="100" value="30">
    </div>  

    <script>
        window.onload = function () {
            const audio = document.getElementById("background-audio");
            let volume = 0;
            audio.volume = 0;
            audio.play();

            // Gradually increase volume
            const interval = setInterval(() => {
                if (volume < 0.15) {
                    volume += 0.025;
                    audio.volume = volume;
                } else {
                    clearInterval(interval);
                }
            }, 1000);

            audio.addEventListener("ended", () => {
                audio.currentTime = 0;
                audio.play();
            });
        };

        document.addEventListener("DOMContentLoaded", function () {
            const audio = document.getElementById("background-audio");
            const muteButton = document.getElementById("mute-btn");
            const volumeSlider = document.getElementById("volume-slider");
            const playPauseButton = document.getElementById("play-pause-btn");

            muteButton.addEventListener("click", function () {
                audio.muted = !audio.muted;
                muteButton.textContent = audio.muted ? "🔇" : "🔊";
            });

            volumeSlider.addEventListener("input", function () {
                audio.volume = volumeSlider.value / 100;
            });

            // Play/Pause button functionality
            playPauseButton.addEventListener("click", function () {
                if (audio.paused) {
                    audio.play();
                    playPauseButton.textContent = "⏸️"; // Change to pause icon
                } else {
                    audio.pause();
                    playPauseButton.textContent = "▶️"; // Change to play icon
                }
            });
        });

        document.addEventListener('DOMContentLoaded', function() {
        const photoCollage = document.querySelector('.photo-collage');
        
        // Image sources - using absolute URLs or properly validated local paths
        const imageSources = [
            { src: "images/claudia1.jpg", alt: "claudia1" },
            { src: "images/claudia2.jpg", alt: "claudia2" },
            { src: "images/img (1).jpg", alt: "img1" },
            { src: "images/img (2).jpg", alt: "img2" },
            { src: "images/img (3).jpg", alt: "img3" },
            { src: "images/img (4).jpg", alt: "img4" },
            { src: "images/img (5).jpg", alt: "img5" },
            { src: "images/img (6).jpg", alt: "img6" },
            { src: "images/img (7).jpg", alt: "img7" },
            { src: "images/img (8).jpg", alt: "img8" },
            { src: "images/img (9).jpg", alt: "img9" },
            { src: "images/img (10).jpg", alt: "img10" },
            { src: "images/img (11).jpg", alt: "img11" },
            { src: "images/img (12).jpg", alt: "img12" },
            { src: "images/img (13).jpg", alt: "img13" },
            { src: "images/img (14).jpg", alt: "img14" },
            { src: "images/img (15).jpg", alt: "img15" },
            { src: "images/img (16).jpg", alt: "img16" },
            { src: "images/img (17).jpg", alt: "img17" },
            { src: "images/img (18).jpg", alt: "img18" },
            { src: "images/img (19).jpg", alt: "img19" },
            { src: "images/img (20).jpg", alt: "img20" },
            { src: "images/img (21).jpg", alt: "img21" },
            { src: "images/img (22).jpg", alt: "img22" },
            { src: "images/img (23).jpg", alt: "img23" },
            { src: "images/img (24).jpg", alt: "img24" },
            { src: "images/img (25).jpg", alt: "img25" },
            { src: "images/img (26).jpg", alt: "img26" },
            { src: "images/img (27).jpg", alt: "img27" }
        ];
        
        // Set the dimensions for the collage container to better handle positioning
        photoCollage.style.height = '1200px';  // Increased height to avoid overcrowding
        
        // Track occupied spaces to avoid overlap
        const occupiedSpaces = [];
        
        // Function to check if a position would overlap with existing photos
        function wouldOverlap(left, top, width, height) {
            // Add buffer zone around photos
            const buffer = 10;
            
            for (const space of occupiedSpaces) {
                if (
                    left < space.right + buffer &&
                    left + width + buffer > space.left &&
                    top < space.bottom + buffer &&
                    top + height + buffer > space.top
                ) {
                    return true;  // Overlap detected
                }
            }
            return false;  // No overlap
        }
        
        // Function to find a non-overlapping position
        // Replace the findSafePosition function with this improved version
        function findSafePosition(width, height, containerWidth, containerHeight) {
            let tries = 0;
            let left, top;
            
            // Get actual container dimensions
            const isMobile = window.innerWidth <= 768;
            const effectiveWidth = isMobile ? containerWidth - width - 20 : containerWidth - width - 40;
            
            // Try up to 50 times to find a non-overlapping position
            do {
                // On mobile, be more careful with horizontal positioning
                left = Math.floor(Math.random() * effectiveWidth) + (isMobile ? 10 : 20);
                top = Math.floor(Math.random() * (containerHeight - height - 40)) + 20;
                tries++;
                
                if (tries > 50) {
                    console.log("Couldn't find non-overlapping position after 50 tries");
                    break;
                }
            } while (wouldOverlap(left, top, width, height));
            
            // Record this position as occupied
            occupiedSpaces.push({
                left: left,
                top: top,
                right: left + width,
                bottom: top + height,
            });
            
            return { left, top };
        }
        
        // Create photo items with non-overlapping positions
        // Replace or modify the photo creation code block (in the imageSources.forEach loop)
        imageSources.forEach((img, index) => {
            const photoItem = document.createElement('div');
            photoItem.className = 'photo-item';
            photoItem.dataset.img = `img-${index}`;
            
            // Adjust dimensions based on screen size
            const isMobile = window.innerWidth <= 768;
            const width = isMobile ? 120 : 180;  // Smaller on mobile
            const height = isMobile ? 80 : 120;  // Smaller on mobile
            
            // Find a safe position
            const containerWidth = photoCollage.clientWidth || (isMobile ? 300 : 1000);
            const containerHeight = isMobile ? 1500 : 1200;
            const position = findSafePosition(width, height, containerWidth, containerHeight);
            
            // Apply position
            photoItem.style.top = `${position.top}px`;
            photoItem.style.left = `${position.left}px`;
            
            // Less extreme rotation on mobile
            const randomRotation = isMobile ? 
                (Math.floor(Math.random() * 20) - 10) : 
                (Math.floor(Math.random() * 30) - 15);
            photoItem.style.setProperty('--rotation', `${randomRotation}deg`);
            
            // Create image element
            const imgElement = document.createElement('img');
            imgElement.src = img.src;
            imgElement.alt = img.alt;
            
            photoItem.appendChild(imgElement);
            photoCollage.appendChild(photoItem);
            
            // Add click event for photo modal
            photoItem.addEventListener('click', function() {
                const modalImage = document.getElementById('modalImage');
                modalImage.src = img.src;
                document.getElementById('photoModal').classList.add('active');
            });
        });
        
        // Photo modal close functionality
        const modalClose = document.querySelector('.photo-modal-close');
        const photoModal = document.getElementById('photoModal');
        
        modalClose.addEventListener('click', function() {
            photoModal.classList.remove('active');
        });
        
        photoModal.addEventListener('click', function(e) {
            if (e.target === this) {
                photoModal.classList.remove('active');
            }
        });
    });

        // Click screen to start interaction
        document.getElementById('introSection').addEventListener('click', function() {
            // Show love question
            document.getElementById('loveQuestion').classList.remove('hidden');
        });
        
        // Answer buttons handlers
        document.getElementById('yesButton').addEventListener('click', handleLoveAnswer);
        document.getElementById('yesyesButton').addEventListener('click', handleLoveAnswer);
        
        function handleLoveAnswer() {
            // Hide question and intro section
            document.getElementById('loveQuestion').classList.add('hidden');
            document.getElementById('introSection').classList.add('hidden');
            
            showStiamMessage();
            
            // Show envelope section
            const envelopeSection = document.getElementById('envelopeSection');
            envelopeSection.classList.remove('hidden');
            
            // Show home button
            document.getElementById('homeButton').classList.remove('hidden');
            
            // Show envelope with animation
            const envelopeContainer = document.querySelector('.envelope-section');
            envelopeContainer.style.opacity = 1;
            envelopeContainer.style.transform = 'translateY(0)';
            
            // Allow scrolling
            document.body.classList.remove('scroll-disabled');
        }
        
        // Confetti function
        function launchConfetti() {
            const duration = 3000;
            const animationEnd = Date.now() + duration;
            const defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };

            function randomInRange(min, max) {
                return Math.random() * (max - min) + min;
            }

            const interval = setInterval(function() {
                const timeLeft = animationEnd - Date.now();

                if (timeLeft <= 0) {
                    return clearInterval(interval);
                }

                const particleCount = 50 * (timeLeft / duration);
                
                // Use random colors
                confetti(Object.assign({}, defaults, { 
                    particleCount, 
                    origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 },
                    colors: ['#ff6b6b', '#ffb8b8', '#f783ac', '#da77f2', '#9775fa']
                }));
                confetti(Object.assign({}, defaults, { 
                    particleCount, 
                    origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 },
                    colors: ['#ff6b6b', '#ffb8b8', '#f783ac', '#da77f2', '#9775fa']
                }));
            }, 250);
        }

        // Girlfriend buttons handlers
        document.getElementById('yesButton2').addEventListener('click', handleGirlfriendAnswer);
        document.getElementById('yesyesButton2').addEventListener('click', handleGirlfriendAnswer);


        document.getElementById('viewGirlfriendButton').addEventListener('click', function() {
            // Show girlfriend question
            document.getElementById('girlfriendQuestion').classList.remove('hidden');
        });

        // Replace the handleGirlfriendAnswer function with this updated version
        function handleGirlfriendAnswer() {
            // Hide the girlfriend question
            document.getElementById('girlfriendQuestion').classList.add('hidden');
            document.getElementById('viewGirlfriendButton').classList.add('hidden');

            // Launch confetti
            launchConfetti();
            
            // Directly transition to the photo gallery instead of showing another button
            const letterSection = document.querySelector('.letter-section');
            const photoGallerySection = document.getElementById('photoGallerySection');
            
            // Apply transition effect
            letterSection.style.opacity = '0';
            letterSection.style.transform = 'scale(0.9)';
            
            setTimeout(() => {
                // Hide letter section
                letterSection.classList.add('hidden');
                
                // Show photo gallery section
                photoGallerySection.classList.remove('hidden');
                photoGallerySection.style.opacity = '0';
                photoGallerySection.style.transform = 'scale(0.9)';
                
                setTimeout(() => {
                    // Fade in photo gallery
                    photoGallerySection.style.opacity = '1';
                    photoGallerySection.style.transform = 'scale(1)';
                    photoGallerySection.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                }, 100);
            }, 1000); // Slightly longer delay to enjoy the confetti
        }
        
        // Envelope click interaction
        document.querySelector('.envelope-container').addEventListener('click', function() {
            const letterSection = document.querySelector('.letter-section');
            const letterContainer = document.querySelector('.letter-container');

            // Apply transition to envelope
            document.getElementById('envelopeSection').style.opacity = '0';
            document.getElementById('envelopeSection').style.transform = 'scale(0.9)';
            
            setTimeout(() => {
                // Hide envelope section
                document.getElementById('envelopeSection').classList.add('hidden');
                
                // Reveal letter section
                letterSection.classList.remove('hidden');
                
                // Fade in letter with animation
                setTimeout(() => {
                    letterContainer.style.opacity = '1';
                    letterContainer.style.transform = 'translateY(0)';
                }, 100);
            }, 500);
        });

        // Home button functionality
        document.getElementById('homeButton').addEventListener('click', function() {
            window.location.reload();
        });

        // Keyboard accessibility
        document.querySelector('.envelope-container').addEventListener('keydown', function(e) {
            if (e.key === 'Enter' || e.key === ' ') {
                this.click();
            }
        });
        
        function showStiamMessage() {
            const stiamMessage = document.getElementById('stiamMessage');
            stiamMessage.style.opacity = '1';
            
            setTimeout(() => {
                stiamMessage.style.opacity = '0';
            }, 1500);
        }
    </script>
    <audio id="background-audio" loop autoplay>
        <source src="music/fly-me-to-the-moon-piano.mp3" type="audio/mp3">
        Your browser does not support the audio element.
    </audio>  
</body>
</html>